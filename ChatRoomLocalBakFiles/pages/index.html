<!DOCTYPE html>
<html>
    <head>
        <title>Real-Time Aircraft Map</title>
        <!-- <style type='text/css'>body{margin:0;padding:0;overflow:hidden;font-family:'Segoe UI',Helvetica,Arial,Sans-Serif}</style> -->

        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous"> -->
        <link rel="stylesheet" href="/css/bootstrap.css">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/2.2.3/fabric.js"></script>
        <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=AqJE7zYyzdIzgJoI-qIn_BBB2WHPGFQ_cWxfqi4T0mYf2UsReMxPnbUXHLyhoh-3&'></script>
        <script type="text/javascript" src="scripts/signalr.js"></script>
        <script type="text/javascript" src="scripts/connect-signalr.js"></script>
        <!-- <script type='text/javascript' src='./scripts/map.js'></script> -->
        <!-- <script type='text/javascript' src='./scripts/map-pushpin.js'></script> -->
        <script type='text/javascript' src='./scripts/map-canvas.js'></script>
        <script type='text/javascript'>

            // configuration
            var debug = false;
            var useLocalSignalR = true;

            // global var
            var map;
            var pushpinLayer;
            var aircraftDict = {};
            var updateDuration = 30 * 1000;
            var updateDelay = 30;
            var start, end;
            var isInit = false;
            var cityLocation;
            var showTitle = debug ? true : false;
            var username;
            var accessToken = '';
            
            function generateRandomName() {
                return Math.random().toString(36).substring(2, 10);
            }

            $(()=>{
                var username = generateRandomName();
                console.log("Connecting signalR username", username);
                
                if (!useLocalSignalR)
                    getAccessToken(`/api/auth/chat?uid=${username}`)
                    .then(function(endpoint) {
                        accessToken = endpoint.accessToken;
                        return startConnection(endpoint.serviceUrl, configureConnection);
                    })
                    .then(onConnected)
                    .catch(onConnectionError);
                else
                    startConnection('/chat', configureConnection)
                    .then(onConnected)
                    .catch(onConnectionError);

                
            });
        </script>
        
    </head>
    <body>
        
        
        <!-- <div id='printoutPanel'></div> -->
        <div id='myMap' style='width: 100vw; height: 100vh;'></div>
        <!-- <div id='footer' style='width: 100vw; height: 10vh;'>
            <button id='startUpdate'>Start</button>
        </div> -->
    </body>
</html>


        <!-- <div id='myMap' style='width: 100vw; height: 100vh;'></div> -->
